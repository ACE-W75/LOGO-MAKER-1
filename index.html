<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Professional AI Logo Studio - Classic Edition">
    <title>NEXUS STUDIO | AI Logo Architect</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Kufi+Arabic:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* --- Color Palette: Midnight Luxury --- */
            --bg-main: #0a0a0f; /* Deepest background */
            --bg-secondary: #121218; /* Panels background */
            --bg-tertiary: #1a1a24; /* Inputs and cards */
            
            --accent-primary: #d4af37; /* Classic Gold */
            --accent-secondary: #3b82f6; /* Professional Blue */
            --accent-success: #10b981;
            --accent-danger: #ef4444;

            --text-primary: #ffffff;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;

            --border-light: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(212, 175, 55, 0.5); /* Gold hover */

            /* --- Typography --- */
            --font-en: 'Inter', sans-serif;
            --font-ar: 'Noto Kufi Arabic', sans-serif;

            /* --- Effects --- */
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
            --glow-gold: 0 0 20px rgba(212, 175, 55, 0.2);
        }

        /* --- Base Reset & Typography --- */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            scrollbar-width: thin;
            scrollbar-color: var(--bg-tertiary) var(--bg-main);
        }
        
        html, body {
            height: 100%;
            background-color: var(--bg-main);
            color: var(--text-primary);
            font-family: var(--font-ar);
            overflow: hidden;
        }

        /* --- scrollbar styling --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-main); }
        ::-webkit-scrollbar-thumb { background-color: var(--bg-tertiary); border-radius: 20px; }

        /* --- Utility Classes & Components --- */
        .panel-classic {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .input-classic {
            width: 100%;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            color: var(--text-primary);
            padding: 14px 16px;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s;
            outline: none;
        }
        
        .input-classic:focus {
            border-color: var(--accent-primary);
            box-shadow: var(--glow-gold);
        }
        
        .input-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        .btn-gold {
            background: linear-gradient(135deg, var(--accent-primary), #b89225);
            color: black;
            font-weight: 700;
            padding: 14px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-gold:hover {
            box-shadow: var(--glow-gold);
            transform: translateY(-2px);
        }
        .btn-gold:active { transform: translateY(0); }
        .btn-gold:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-light);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-secondary:hover { border-color: var(--text-secondary); background: var(--bg-main); }

        /* --- Layout Structure --- */
        #app-container {
            display: grid;
            grid-template-columns: 420px 1fr; /* Fixed sidebar, fluid main content */
            height: 100vh;
        }

        #sidebar {
            background-color: var(--bg-secondary);
            border-left: 1px solid var(--border-light);
            padding: 24px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        #main-viewport {
            background-color: var(--bg-main);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            overflow-y: auto;
        }

        /* --- Specific Components --- */
        /* Style Selector Cards */
        .style-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        .style-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            padding: 16px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        .style-card:hover { border-color: var(--accent-secondary); }
        .style-card.active {
            background: rgba(212, 175, 55, 0.1);
            border-color: var(--accent-primary);
        }
        .style-card i { font-size: 1.5rem; margin-bottom: 8px; color: var(--text-secondary); }
        .style-card.active i { color: var(--accent-primary); }

        /* The Canvas/Image Area */
        .viewport-stage {
            flex: 1;
            min-height: 500px;
            background-image: 
                linear-gradient(45deg, var(--bg-tertiary) 25%, transparent 25%), 
                linear-gradient(-45deg, var(--bg-tertiary) 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, var(--bg-tertiary) 75%), 
                linear-gradient(-45deg, transparent 75%, var(--bg-tertiary) 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            border-radius: 16px;
            border: 1px solid var(--border-light);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        #main-canvas {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            box-shadow: var(--shadow-lg);
            transition: filter 0.3s ease;
        }

        /* Advanced Loader */
        .loader-overlay {
            position: absolute; inset: 0;
            background: rgba(10, 10, 15, 0.85);
            backdrop-filter: blur(10px);
            z-index: 50;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.5s;
        }
        .loader-overlay.active { opacity: 1; pointer-events: all; }
        
        .gold-spinner {
            width: 60px; height: 60px;
            border: 4px solid var(--border-light);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Range Sliders for Editor */
        .slider-group { margin-bottom: 16px; }
        .slider-header { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .classic-range {
            width: 100%; -webkit-appearance: none; height: 6px; border-radius: 5px; background: var(--bg-tertiary); outline: none;
        }
        .classic-range::-webkit-slider-thumb {
            -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: var(--accent-primary); cursor: pointer; transition: 0.2s;
        }
        .classic-range::-webkit-slider-thumb:hover { transform: scale(1.2); box-shadow: var(--glow-gold); }

        /* Responsive Design */
        @media (max-width: 1024px) {
            #app-container { grid-template-columns: 1fr; height: auto; overflow-y: auto; }
            #sidebar { height: auto; border-left: none; border-bottom: 1px solid var(--border-light); }
            #main-viewport { height: auto; min-height: 70vh; }
        }
    </style>
</head>
<body>

    <div id="app-container">
        
        <aside id="sidebar">
            <div class="flex items-center gap-3 pb-6 border-b border-border-light">
                <div class="w-10 h-10 bg-gradient-to-br from-accent-primary to-orange-600 rounded-lg flex items-center justify-center shadow-lg">
                    <i class="fa-solid fa-vector-square text-bg-main text-xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-accent-primary leading-none">NEXUS STUDIO</h1>
                    <span class="text-xs text-text-secondary tracking-widest">CLASSIC EDITION v2.0</span>
                </div>
            </div>

            <div class="space-y-6">
                <div>
                    <h2 class="text-sm text-accent-primary font-bold uppercase tracking-wider mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-layer-group"></i> أساسيات المشروع
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label for="brandName" class="input-label">اسم العلامة التجارية (Brand Name)</label>
                            <input type="text" id="brandName" placeholder="اكتب الاسم هنا..." class="input-classic text-lg font-bold" autocomplete="off">
                        </div>
                        <div>
                            <label for="tagline" class="input-label">الشعار اللفظي (اختياري)</label>
                            <input type="text" id="tagline" placeholder="مثال: Quality since 2020" class="input-classic">
                        </div>
                    </div>
                </div>

                <div>
                    <h2 class="text-sm text-accent-primary font-bold uppercase tracking-wider mb-4 flex items-center gap-2 mt-6">
                        <i class="fa-solid fa-compass-drafting"></i> التوجيه البصري
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label for="visualElement" class="input-label">العنصر الرمزي (Visual Symbol)</label>
                            <div class="relative">
                                <input type="text" id="visualElement" placeholder="مثال: رأس أسد هندسي، درع حماية..." class="input-classic pr-10">
                                <i class="fa-solid fa-lightbulb absolute right-4 top-1/2 -translate-y-1/2 text-text-muted"></i>
                            </div>
                            <div class="flex gap-2 mt-3 flex-wrap">
                                <button onclick="app.fillInput('visualElement', 'Geometric Falcon')" class="text-xs bg-bg-tertiary border border-border-light px-3 py-1.5 rounded-full hover:border-accent-primary transition">صقر هندسي</button>
                                <button onclick="app.fillInput('visualElement', 'Abstract Tech Circuit')" class="text-xs bg-bg-tertiary border border-border-light px-3 py-1.5 rounded-full hover:border-accent-primary transition">دائرة تقنية</button>
                                <button onclick="app.fillInput('visualElement', 'Minimalist Mountain')" class="text-xs bg-bg-tertiary border border-border-light px-3 py-1.5 rounded-full hover:border-accent-primary transition">جبل بسيط</button>
                            </div>
                        </div>

                        <div>
                            <label class="input-label mb-3">الأسلوب الفني (Artistic Style)</label>
                            <div class="style-grid">
                                <div class="style-card active" onclick="app.selectStyle(this, 'classic_luxury')">
                                    <i class="fa-solid fa-crown"></i>
                                    <div class="text-sm font-bold">Classic Luxury</div>
                                </div>
                                <div class="style-card" onclick="app.selectStyle(this, 'modern_minimal')">
                                    <i class="fa-solid fa-bezier-curve"></i>
                                    <div class="text-sm font-bold">Modern Minimal</div>
                                </div>
                                <div class="style-card" onclick="app.selectStyle(this, 'vintage_badge')">
                                    <i class="fa-solid fa-certificate"></i>
                                    <div class="text-sm font-bold">Vintage Badge</div>
                                </div>
                                <div class="style-card" onclick="app.selectStyle(this, 'abstract_mark')">
                                    <i class="fa-brands fa-codepen"></i>
                                    <div class="text-sm font-bold">Abstract Mark</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="pt-4">
                            <label class="flex items-center gap-3 cursor-pointer group">
                                <input type="checkbox" id="transparentBg" class="w-5 h-5 accent-accent-primary cursor-pointer">
                                <span class="text-sm text-text-secondary group-hover:text-text-primary transition">طلب خلفية شفافة (PNG)</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-auto pt-6 border-t border-border-light sticky bottom-0 bg-bg-secondary">
                <button id="generateBtn" onclick="core.initiateGeneration()" class="btn-gold w-full text-lg">
                    <i class="fa-solid fa-wand-magic-sparkles"></i>
                    <span>بدء تصميم الشعار</span>
                </button>
                <p id="statusText" class="text-center text-xs text-text-muted mt-3 font-mono h-4"></p>
            </div>
        </aside>

        <main id="main-viewport">
            <div class="flex justify-between items-center">
                <h2 class="text-xl font-bold flex items-center gap-2">
                    <i class="fa-solid fa-image"></i> مساحة العمل
                </h2>
                <button onclick="gallery.toggle()" class="btn-secondary text-sm">
                    <i class="fa-solid fa-clock-rotate-left"></i> السجل
                </button>
            </div>

            <div class="viewport-stage panel-classic relative group">
                <div id="stagePlaceholder" class="text-center text-text-muted flex flex-col items-center transition-all duration-300">
                    <i class="fa-solid fa-compass-drafting text-6xl mb-4 opacity-50"></i>
                    <h3 class="text-xl font-bold text-text-primary mb-2">اللوحة جاهزة</h3>
                    <p class="max-w-md">أدخل تفاصيل مشروعك في القائمة الجانبية لبدء عملية التصميم.</p>
                </div>

                <canvas id="main-canvas" class="hidden"></canvas>

                <div id="loaderOverlay" class="loader-overlay">
                    <div class="gold-spinner mb-6"></div>
                    <h3 class="text-xl font-bold text-accent-primary mb-2 tracking-wider">جاري المعالجة</h3>
                    <p id="loaderStatus" class="text-text-secondary font-mono text-sm">Initializing AI Core...</p>
                    <div class="w-64 h-1.5 bg-bg-tertiary rounded-full mt-6 overflow-hidden">
                        <div id="progressBar" class="h-full bg-accent-primary w-0 transition-all duration-[10s] ease-out"></div>
                    </div>
                </div>
            </div>

            <div id="editorPanel" class="panel-classic p-6 hidden animate-pulse">
                <div class="flex justify-between items-center mb-6 pb-4 border-b border-border-light">
                     <h3 class="font-bold text-lg flex items-center gap-2">
                        <i class="fa-solid fa-sliders"></i> محرر اللمسات الأخيرة
                    </h3>
                    <div class="flex gap-2">
                        <button onclick="editor.reset()" class="btn-secondary text-xs px-3 py-1.5">إعادة تعيين</button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="space-y-4">
                        <h4 class="text-xs font-bold text-text-secondary uppercase">الإضاءة والتباين</h4>
                        <div class="slider-group">
                            <div class="slider-header"><span>السطوع (Brightness)</span><span id="val-brightness">100%</span></div>
                            <input type="range" id="in-brightness" min="50" max="150" value="100" class="classic-range" oninput="editor.update('brightness', this.value)">
                        </div>
                        <div class="slider-group">
                            <div class="slider-header"><span>التباين (Contrast)</span><span id="val-contrast">100%</span></div>
                            <input type="range" id="in-contrast" min="50" max="150" value="100" class="classic-range" oninput="editor.update('contrast', this.value)">
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <h4 class="text-xs font-bold text-text-secondary uppercase">الألوان والتشبع</h4>
                        <div class="slider-group">
                            <div class="slider-header"><span>التشبع (Saturation)</span><span id="val-saturate">100%</span></div>
                            <input type="range" id="in-saturate" min="0" max="200" value="100" class="classic-range" oninput="editor.update('saturate', this.value)">
                        </div>
                        <div class="slider-group">
                            <div class="slider-header"><span>تدريج اللون (Hue)</span><span id="val-hue-rotate">0deg</span></div>
                            <input type="range" id="in-hue-rotate" min="0" max="360" value="0" class="classic-range" oninput="editor.update('hue-rotate', this.value, 'deg')">
                        </div>
                    </div>

                     <div class="flex flex-col justify-between gap-4">
                        <div>
                            <h4 class="text-xs font-bold text-text-secondary uppercase mb-3">لوحة الألوان المستخرجة</h4>
                            <div id="colorPalette" class="flex gap-2 p-2 bg-bg-tertiary rounded-lg">
                                <span class="text-xs text-text-muted">سيتم استخراج الألوان بعد الإنشاء</span>
                            </div>
                        </div>
                        <button id="downloadBtn" onclick="editor.download()" class="btn-gold w-full py-4 mt-auto">
                            <i class="fa-solid fa-download"></i> تحميل الشعار النهائي (HD)
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <div id="gallerySidebar" class="fixed top-0 right-0 h-full w-80 bg-bg-secondary border-l border-border-light z-50 transform translate-x-full transition-transform duration-300 p-6 overflow-y-auto shadow-2xl">
             <div class="flex justify-between items-center mb-6">
                <h3 class="font-bold text-lg"><i class="fa-solid fa-clock-rotate-left mr-2"></i>سجل التصاميم</h3>
                <button onclick="gallery.toggle()" class="text-text-secondary hover:text-text-primary"><i class="fa-solid fa-times text-xl"></i></button>
            </div>
            <div id="galleryGrid" class="grid grid-cols-1 gap-4">
                </div>
             <button onclick="gallery.clear()" class="btn-secondary w-full mt-6 text-accent-danger border-accent-danger/30 hover:bg-accent-danger/10">
                <i class="fa-solid fa-trash"></i> مسح السجل
            </button>
        </div>
    </div>

    <script>
        /**
         * GLOBAL CONFIGURATION & STATE
         * Defines base API endpoints, style prompts, and active application state.
         */
        const CONFIG = {
            // Using the most reliable endpoint path based on recent tests
            apiBase: "https://image.pollinations.ai/prompt/",
            
            // Pre-defined professional prompt modifiers
            styles: {
                classic_luxury: "luxury logo design, classic emblem, elegant serif typography, gold and deep rich colors, metallic texture, premium branding, centered, highly detailed, 8k resolution",
                modern_minimal: "minimalist logo, modern flat design, clean geometric lines, sans-serif font, abstract icon, balanced, negative space, isolated on plain background",
                vintage_badge: "vintage retro badge logo, textured stamp effect, old school typography, circular emblem, rustic colors, intricate details, grunge texture",
                abstract_mark: "abstract logo mark, futuristic shapes, gradient colors, fluid design, tech company branding, innovative symbol, clean render"
            },

            // Status messages for the loader
            statusMessages: [
                "جاري تهيئة محرك الذكاء الاصطناعي...",
                "تحليل مدخلات العلامة التجارية...",
                "رسم الخطوط الأولية...",
                "تطبيق أسلوب التصميم المختار...",
                "إضافة اللمسات النهائية والظلال...",
                "جاري تحسين الدقة (Upscaling)..."
            ]
        };

        // Main State Object
        let state = {
            isGenerating: false,
            currentStyle: 'classic_luxury',
            currentImageUrl: null,
            // Editor filter values
            filters: {
                brightness: 100,
                contrast: 100,
                saturate: 100,
                'hue-rotate': 0,
                sepia: 0
            },
            // History array loaded from local storage
            history: JSON.parse(localStorage.getItem('nexus_history')) || []
        };

        /**
         * MODULE: UI CONTROLLER (app)
         * Handles general interface interactions.
         */
        const app = {
            init() {
                // Initial setup on page load
                gallery.render();
                console.log("Nexus Studio: Classic Edition Initialized.");
            },

            // Helper to fill example inputs
            fillInput(id, value) {
                document.getElementById(id).value = value;
            },

            // Handle style card selection
            selectStyle(element, styleKey) {
                if (state.isGenerating) return;
                // Update UI
                document.querySelectorAll('.style-card').forEach(el => el.classList.remove('active'));
                element.classList.add('active');
                // Update State
                state.currentStyle = styleKey;
            },

            // Update status text near the button
            setStatus(msg, type = 'normal') {
                const el = document.getElementById('statusText');
                el.innerText = msg;
                el.className = type === 'error' ? 'text-center text-xs text-accent-danger mt-3 font-mono h-4' : 'text-center text-xs text-text-muted mt-3 font-mono h-4';
            }
        };

        /**
         * MODULE: CORE ENGINE (core)
         * Handles the generation process, API calls, and loading states.
         */
        const core = {
            async initiateGeneration() {
                if (state.isGenerating) return;

                // 1. Validation
                const brandName = document.getElementById('brandName').value.trim();
                if (!brandName) {
                    alert("يرجى إدخال اسم العلامة التجارية أولاً.");
                    document.getElementById('brandName').focus();
                    return;
                }

                // 2. Prepare State & UI
                state.isGenerating = true;
                const generateBtn = document.getElementById('generateBtn');
                generateBtn.disabled = true;
                generateBtn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i><span>جاري العمل...</span>';
                
                document.getElementById('stagePlaceholder').classList.add('hidden');
                document.getElementById('editorPanel').classList.add('hidden');
                this.toggleLoader(true);

                // 3. Construct the Advanced Prompt
                const visualElement = document.getElementById('visualElement').value.trim();
                const tagline = document.getElementById('tagline').value.trim();
                const isTransparent = document.getElementById('transparentBg').checked;
                
                const baseStyle = CONFIG.styles[state.currentStyle];
                
                let fullPrompt = `${baseStyle}. A professional logo for brand "${brandName}".`;
                if (visualElement) fullPrompt += ` Featuring an icon of: ${visualElement}.`;
                if (tagline) fullPrompt += ` Incorporating the tagline: "${tagline}".`;
                if (isTransparent) fullPrompt += ` Isolated on a transparent background, no background elements.`;
                else fullPrompt += ` Centered on a clean professional background.`;

                console.log("Generating with prompt:", fullPrompt);

                // 4. API Call with "Smart Routing" (Retries)
                // We use a random seed to prevent caching and force a new generation.
                const seed = Math.floor(Math.random() * 99999999);
                constencodedPrompt = encodeURIComponent(fullPrompt);
                
                // Primary URL structure (most reliable currently)
                const targetUrl = `${CONFIG.apiBase}${encodedPrompt}?width=1024&height=1024&seed=${seed}&nologo=true&model=turbo`; // Adding model=turbo for speed

                try {
                    await this.loadImageWithFallback(targetUrl);
                    // Success handled in loadImageWithFallback callback
                } catch (error) {
                    console.error("Generation Failed:", error);
                    app.setStatus("فشل الاتصال بالسيرفر. يرجى المحاولة مرة أخرى.", "error");
                    this.resetUIState();
                }
            },

            // Smart Image Loader with timeout and error handling
            loadImageWithFallback(url) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.crossOrigin = "Anonymous"; // Crucial for Canvas editing later

                    // Timeout warning
                    const timeoutToast = setTimeout(() => {
                         app.setStatus("الاتصال يستغرق وقتاً أطول من المعتاد...");
                    }, 8000);

                    img.onload = () => {
                        clearTimeout(timeoutToast);
                        this.handleGenerationSuccess(img, url);
                        resolve(url);
                    };

                    img.onerror = () => {
                        clearTimeout(timeoutToast);
                        // Simple retry logic could be added here, but for now fail fast.
                        reject(new Error("Image failed to load"));
                    };

                    img.src = url;
                });
            },

            handleGenerationSuccess(imgObj, url) {
                // Update State
                state.currentImageUrl = url;
                
                // Initialize Editor with the new image
                editor.init(imgObj);
                
                // Save to History
                gallery.add(url, document.getElementById('brandName').value);

                // Update UI
                this.resetUIState();
                document.getElementById('editorPanel').classList.remove('hidden');
                app.setStatus("تم إنشاء الشعار بنجاح!");
                // Extract colors (simple simulation for now)
                this.extractColors();
            },

            toggleLoader(show) {
                 const loader = document.getElementById('loaderOverlay');
                 const progressBar = document.getElementById('progressBar');
                 const statusText = document.getElementById('loaderStatus');

                 if (show) {
                     loader.classList.add('active');
                     progressBar.style.width = '100%'; // Start animation
                     
                     // Cycle status messages
                     let msgIndex = 0;
                     statusText.innerText = CONFIG.statusMessages[0];
                     this.msgInterval = setInterval(() => {
                         msgIndex = (msgIndex + 1) % CONFIG.statusMessages.length;
                         statusText.innerText = CONFIG.statusMessages[msgIndex];
                     }, 2000);

                 } else {
                     loader.classList.remove('active');
                     progressBar.style.width = '0';
                     clearInterval(this.msgInterval);
                 }
            },

            resetUIState() {
                state.isGenerating = false;
                this.toggleLoader(false);
                const generateBtn = document.getElementById('generateBtn');
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fa-solid fa-wand-magic-sparkles"></i><span>بدء تصميم الشعار</span>';
            },

            // Simulates color extraction (a real one needs complex JS libraries)
            extractColors() {
                const paletteContainer = document.getElementById('colorPalette');
                paletteContainer.innerHTML = '';
                
                // Generate 4 pseudo-random complementary colors based on the style
                const baseColors = state.currentStyle === 'classic_luxury' ? ['#d4af37', '#0a0a0f', '#ffffff', '#888888'] : 
                                   state.currentStyle === 'modern_minimal' ? ['#3b82f6', '#ffffff', '#000000', '#e5e7eb'] :
                                   ['#FF5733', '#C70039', '#900C3F', '#581845']; // Fallback

                baseColors.forEach(color => {
                    const colorDot = document.createElement('div');
                    colorDot.className = 'w-8 h-8 rounded-full border border-border-light shadow-sm cursor-pointer hover:scale-110 transition';
                    colorDot.style.backgroundColor = color;
                    colorDot.title = color;
                    colorDot.onclick = () => { navigator.clipboard.writeText(color); alert(`تم نسخ كود اللون: ${color}`); };
                    paletteContainer.appendChild(colorDot);
                });
            }
        };

        /**
         * MODULE: IMAGE EDITOR (editor)
         * Handles canvas manipulation for post-processing features.
         */
        const editor = {
            canvas: null,
            ctx: null,
            originalImage: null,

            init(imgObj) {
                this.canvas = document.getElementById('main-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.originalImage = imgObj;

                // Set canvas dimensions to match image
                this.canvas.width = imgObj.width;
                this.canvas.height = imgObj.height;
                
                // Show canvas
                this.canvas.classList.remove('hidden');

                // Initial Draw
                this.reset();
            },

            // Called when a slider changes
            update(filterType, value, unit = '%') {
                // Update UI label
                document.getElementById(`val-${filterType}`).innerText = value + unit;
                // Update State
                state.filters[filterType] = value;
                // Redraw
                this.applyFilters();
            },

            applyFilters() {
                if (!this.ctx || !this.originalImage) return;

                // Clear previous frame
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // Construct CSS filter string based on state
                const f = state.filters;
                this.ctx.filter = `
                    brightness(${f.brightness}%) 
                    contrast(${f.contrast}%) 
                    saturate(${f.saturate}%) 
                    hue-rotate(${f['hue-rotate']}deg)
                `;

                // Draw the image with filters applied
                this.ctx.drawImage(this.originalImage, 0, 0);
            },

            reset() {
                // Reset state variables
                state.filters = { brightness: 100, contrast: 100, saturate: 100, 'hue-rotate': 0, sepia: 0 };
                
                // Reset sliders UI
                document.getElementById('in-brightness').value = 100; document.getElementById('val-brightness').innerText = '100%';
                document.getElementById('in-contrast').value = 100; document.getElementById('val-contrast').innerText = '100%';
                document.getElementById('in-saturate').value = 100; document.getElementById('val-saturate').innerText = '100%';
                document.getElementById('in-hue-rotate').value = 0; document.getElementById('val-hue-rotate').innerText = '0deg';

                this.applyFilters();
            },

            download() {
                if (!this.canvas) return;
                
                // Use the canvas data (with filters applied)
                const dataURL = this.canvas.toDataURL('image/png');
                
                const link = document.createElement('a');
                link.download = `Nexus_Logo_${Date.now()}.png`;
                link.href = dataURL;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        };

        /**
         * MODULE: GALLERY / HISTORY (gallery)
         * Manages local storage persistence of generated images.
         */
        const gallery = {
            sidebar: document.getElementById('gallerySidebar'),
            grid: document.getElementById('galleryGrid'),

            toggle() {
                this.sidebar.classList.toggle('translate-x-full');
            },

            add(url, name) {
                // Add to state array (limit to last 10)
                state.history.unshift({ url, name, date: new Date().toLocaleDateString() });
                if (state.history.length > 10) state.history.pop();
                
                // Save to LocalStorage
                localStorage.setItem('nexus_history', JSON.stringify(state.history));
                
                this.render();
            },

            render() {
                this.grid.innerHTML = '';
                if (state.history.length === 0) {
                    this.grid.innerHTML = '<p class="text-text-muted text-center py-4">لا يوجد سجل حتى الآن</p>';
                    return;
                }

                state.history.forEach((item, index) => {
                    const card = document.createElement('div');
                    card.className = 'bg-bg-tertiary border border-border-light rounded-lg overflow-hidden flex gap-3 p-2 items-center hover:border-accent-secondary transition cursor-pointer';
                    card.innerHTML = `
                        <img src="${item.url}" class="w-16 h-16 object-cover rounded border border-border-light bg-bg-main">
                        <div class="flex-1 overflow-hidden">
                            <h4 class="font-bold truncate">${item.name}</h4>
                            <span class="text-xs text-text-muted">${item.date}</span>
                        </div>
                        <button onclick="gallery.restore(${index})" class="btn-secondary text-xs px-2 py-1"><i class="fa-solid fa-upload"></i></button>
                    `;
                    this.grid.appendChild(card);
                });
            },

            restore(index) {
                const item = state.history[index];
                // Load image back into editor
                core.toggleLoader(true);
                const img = new Image();
                img.crossOrigin = "Anonymous";
                img.onload = () => {
                    editor.init(img);
                    document.getElementById('editorPanel').classList.remove('hidden');
                    document.getElementById('stagePlaceholder').classList.add('hidden');
                    core.toggleLoader(false);
                    this.toggle(); // Close sidebar
                };
                img.src = item.url;
            },

            clear() {
                if(confirm('هل أنت متأكد من مسح السجل بالكامل؟')) {
                    state.history = [];
                    localStorage.removeItem('nexus_history');
                    this.render();
                }
            }
        };

        // --- Initialize Application ---
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS PRO | استوديو الشعارات الذكي</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --gold: #d4af37;
            --dark-bg: #0f0f12;
            --panel-bg: #1a1a1f;
            --text-gray: #a0a0a8;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--dark-bg);
            color: white;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            /* منع السحب لأسفل لتحديث الصفحة في الهاتف لضمان عدم ضياع العمل */
            overscroll-behavior-y: contain;
        }

        /* تنسيق الأزرار للهاتف - كبيرة وسهلة الضغط */
        .mobile-btn {
            padding: 18px;
            border-radius: 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s active;
            touch-action: manipulation;
        }

        .mobile-btn:active {
            transform: scale(0.95);
            filter: brightness(0.8);
        }

        /* استوديو الصور (Viewport) */
        .image-container {
            width: 100%;
            aspect-ratio: 1 / 1;
            background: #15151a;
            border: 2px solid rgba(212, 175, 55, 0.1);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        #outputImage {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: none;
        }

        /* مشغل التحميل (Loader) */
        .loader-box {
            position: absolute;
            inset: 0;
            background: rgba(15, 15, 18, 0.9);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .gold-ring {
            width: 50px;
            height: 50px;
            border: 4px solid #333;
            border-top: 4px solid var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* قائمة التعديلات السفلية */
        .editor-sheet {
            background: var(--panel-bg);
            border-top: 2px solid var(--gold);
            border-radius: 30px 30px 0 0;
            padding: 20px;
            margin-top: 20px;
        }

        input, select {
            background: #25252b !important;
            border: 1px solid #333 !important;
            color: white !important;
            border-radius: 12px !important;
            padding: 12px !important;
            width: 100%;
        }

        /* تحسين التمرير في الهاتف */
        .scroll-area {
            max-height: 85vh;
            overflow-y: auto;
            padding-bottom: 100px;
        }
    </style>
</head>
<body>

    <div id="welcomeScreen" class="fixed inset-0 z-50 bg-black flex flex-col items-center justify-center p-6 text-center">
        <div class="w-24 h-24 bg-gradient-to-t from-amber-600 to-yellow-300 rounded-3xl mb-6 shadow-2xl flex items-center justify-center">
            <i class="fas fa-crown text-black text-4xl"></i>
        </div>
        <h1 class="text-3xl font-black text-white mb-2">NEXUS STUDIO</h1>
        <p class="text-gray-400 mb-8">مصمم الشعارات الاحترافي لرجال الأعمال</p>
        <button onclick="startApp()" class="mobile-btn bg-white text-black w-full max-w-xs">
            ابدأ التصميم الآن <i class="fas fa-arrow-left"></i>
        </button>
    </div>

    <div id="mainApp" class="hidden min-h-screen flex flex-col p-4 md:p-8 max-w-4xl mx-auto">
        
        <div class="flex justify-between items-center mb-6">
            <div class="flex items-center gap-3">
                <i class="fas fa-gem text-amber-500 text-2xl"></i>
                <span class="font-bold tracking-widest text-xl">NEXUS PRO</span>
            </div>
            <div class="bg-green-500/10 text-green-500 px-3 py-1 rounded-full text-xs font-bold border border-green-500/20">
                مباشر ●
            </div>
        </div>

        <div class="scroll-area">
            <div class="image-container mb-6 group">
                <div id="placeholder" class="absolute inset-0 flex flex-col items-center justify-center text-gray-600">
                    <i class="fas fa-palette text-5xl mb-4"></i>
                    <p>سيظهر شعارك هنا</p>
                </div>
                
                <img id="outputImage" src="" alt="Logo Result">
                
                <div id="loader" class="loader-box">
                    <div class="gold-ring"></div>
                    <p class="mt-4 text-amber-500 font-bold animate-pulse">جاري ابتكار الشعار...</p>
                </div>
            </div>

            <div class="space-y-6">
                <div>
                    <label class="block text-sm font-bold text-gray-400 mb-2">اسم المشروع / البراند</label>
                    <input type="text" id="brandName" placeholder="مثال: الفارس للعقارات">
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-400 mb-2">وصف الرمز (أيقونة الشعار)</label>
                    <input type="text" id="visualInfo" placeholder="مثال: صقر جارح، سيف، بناية حديثة">
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-400 mb-2">نمط التصميم</label>
                    <select id="styleSelect">
                        <option value="luxury gold, premium quality, metallic">ذهبي فاخر (Luxury Gold)</option>
                        <option value="modern minimal, clean lines, flat">عصري بسيط (Modern Minimal)</option>
                        <option value="tech futuristic, cyber, glowing">تقني مستقبلي (Tech/Cyber)</option>
                        <option value="vintage classic, elegant typography">كلاسيكي عتيق (Vintage)</option>
                    </select>
                </div>

                <button onclick="generateLogo()" id="genBtn" class="mobile-btn bg-amber-500 text-black w-full shadow-[0_0_20px_rgba(212,175,55,0.3)]">
                    <i class="fas fa-magic"></i> إنشاء الشعار الآن
                </button>
            </div>

            <div id="editorTools" class="editor-sheet hidden mt-8">
                <h3 class="text-center font-bold mb-6 border-b border-gray-800 pb-4">تعديل اللمسات الأخيرة</h3>
                
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="applyFilter('grayscale(1)')" class="bg-gray-800 p-4 rounded-xl text-xs">أبيض وأسود</button>
                    <button onclick="applyFilter('sepia(0.5)')" class="bg-gray-800 p-4 rounded-xl text-xs">كلاسيكي قديم</button>
                    <button onclick="applyFilter('brightness(1.2) contrast(1.1)')" class="bg-gray-800 p-4 rounded-xl text-xs">إضاءة قوية</button>
                    <button onclick="applyFilter('none')" class="bg-gray-800 p-4 rounded-xl text-xs">إعادة الأصل</button>
                </div>

                <button onclick="downloadImage()" class="mobile-btn bg-white text-black w-full mt-6">
                    <i class="fas fa-download"></i> حفظ الشعار في الهاتف
                </button>
            </div>
        </div>
    </div>

    <script>
        // دالة تشغيل التطبيق
        function startApp() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('mainApp').classList.remove('hidden');
        }

        // دالة التوليد الأساسية - مطورة للهواتف
        async function generateLogo() {
            const brand = document.getElementById('brandName').value;
            const visual = document.getElementById('visualInfo').value;
            const style = document.getElementById('styleSelect').value;

            if (!brand) {
                alert("يرجى كتابة اسم البراند أولاً");
                return;
            }

            // إظهار المحرك
            document.getElementById('loader').style.display = 'flex';
            document.getElementById('placeholder').style.display = 'none';
            document.getElementById('genBtn').disabled = true;

            // بناء الطلب (بصيغة تمنع الحظر)
            const prompt = `professional vector logo, ${brand}, ${visual}, ${style}, white background, centered, high quality`;
            const seed = Math.floor(Math.random() * 999999);
            const imageUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=1024&height=1024&seed=${seed}&nologo=true`;

            const imgElement = document.getElementById('outputImage');
            
            // محاولة تحميل الصورة مع معالجة الخطأ
            const imgChecker = new Image();
            imgChecker.src = imageUrl;
            
            imgChecker.onload = () => {
                imgElement.src = imageUrl;
                imgElement.style.display = 'block';
                document.getElementById('loader').style.display = 'none';
                document.getElementById('editorTools').classList.remove('hidden');
                document.getElementById('genBtn').disabled = false;
                // تمرير الشاشة للأسفل لرؤية النتيجة
                window.scrollTo({ top: 100, behavior: 'smooth' });
            };

            imgChecker.onerror = () => {
                alert("مشكلة في الاتصال بالمخدم. يرجى المحاولة مرة أخرى.");
                document.getElementById('loader').style.display = 'none';
                document.getElementById('genBtn').disabled = false;
            };
        }

        // دوال التحرير
        function applyFilter(filterStr) {
            document.getElementById('outputImage').style.filter = filterStr;
        }

        // دالة التحميل المباشر للهاتف
        function downloadImage() {
            const img = document.getElementById('outputImage');
            const link = document.createElement('a');
            link.href = img.src;
            link.download = 'MyLogo.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS PRO | الإصدار المستقر</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: #050505;
            color: white;
            touch-action: pan-y; /* يسمح فقط بالتمرير الرأسي الطبيعي */
            -webkit-overflow-scrolling: touch;
        }

        /* حاوية الصورة المستقرة */
        .stage-box {
            width: 100%;
            aspect-ratio: 1/1;
            background: #111;
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            border: 2px solid #222;
            overflow: hidden;
        }

        #mainImg {
            max-width: 100%;
            max-height: 100%;
            display: none;
            transition: filter 0.3s ease;
        }

        /* أزرار التحكم الكبيرة للهاتف */
        .step-btn {
            background: #1a1a1a;
            border: 1px solid #333;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            flex: 1;
            touch-action: manipulation;
        }

        .step-btn:active {
            background: #333;
            transform: scale(0.95);
        }

        .primary-btn {
            background: linear-gradient(135deg, #d4af37, #f2d06b);
            color: black;
            font-weight: 800;
            padding: 20px;
            border-radius: 16px;
            width: 100%;
            font-size: 1.1rem;
        }

        /* منع التحديث عند السحب لأسفل */
        html, body { overscroll-behavior-y: contain; }

        .loader-dots {
            display: none;
            gap: 5px;
        }
        .dot { width: 10px; height: 10px; background: #d4af37; border-radius: 50%; animation: bounce 0.5s infinite alternate; }
        .dot:nth-child(2) { animation-delay: 0.1s; }
        .dot:nth-child(3) { animation-delay: 0.2s; }
        @keyframes bounce { to { transform: translateY(-10px); } }
    </style>
</head>
<body class="p-4">

    <div class="flex justify-between items-center mb-6">
        <div>
            <h1 class="text-2xl font-black text-amber-500">NEXUS PRO</h1>
            <p class="text-xs text-gray-500">نظام التصميم الفوري المستقر</p>
        </div>
        <i class="fas fa-shield-alt text-gray-700"></i>
    </div>

    <div class="stage-box mb-6 shadow-2xl" id="stage">
        <div id="placeholder" class="text-center p-8">
            <i class="fas fa-magic text-4xl text-gray-800 mb-4"></i>
            <p class="text-gray-600 text-sm">أدخل البيانات واضغط "إنشاء"</p>
        </div>
        
        <img id="mainImg" src="" alt="Logo">

        <div id="loader" class="absolute inset-0 bg-black/80 flex-col items-center justify-center hidden">
            <div class="loader-dots flex mb-4" id="dots">
                <div class="dot"></div><div class="dot"></div><div class="dot"></div>
            </div>
            <p class="text-amber-500 text-sm font-bold">جاري التصميم...</p>
        </div>
    </div>

    <div class="space-y-4 mb-8">
        <input type="text" id="brand" placeholder="اسم البراند (بالعربية أو الإنجليزية)" 
               class="w-full bg-zinc-900 border border-zinc-800 p-4 rounded-xl outline-none focus:border-amber-500">
        
        <input type="text" id="idea" placeholder="فكرة الرمز (مثلاً: سيف، منزل، تكنولوجيا)" 
               class="w-full bg-zinc-900 border border-zinc-800 p-4 rounded-xl outline-none focus:border-amber-500">

        <button onclick="generate()" id="btnAction" class="primary-btn shadow-lg">
            إنشــــاء الشعار
        </button>
    </div>

    <div id="controls" class="hidden space-y-6 bg-zinc-900/50 p-4 rounded-2xl border border-zinc-800">
        <h3 class="text-sm font-bold text-gray-400 text-center uppercase tracking-widest">تعديل الإضاءة واللون</h3>
        
        <div class="flex gap-2">
            <button onclick="adjust('brightness', -10)" class="step-btn"><i class="fas fa-minus"></i></button>
            <div class="flex-[2] text-center flex flex-col justify-center">
                <span class="text-xs text-gray-500">السطوع</span>
                <span id="brightVal" class="font-bold">100%</span>
            </div>
            <button onclick="adjust('brightness', 10)" class="step-btn"><i class="fas fa-plus"></i></button>
        </div>

        <div class="flex gap-2">
            <button onclick="adjust('contrast', -10)" class="step-btn"><i class="fas fa-minus"></i></button>
            <div class="flex-[2] text-center flex flex-col justify-center">
                <span class="text-xs text-gray-500">التباين</span>
                <span id="contVal" class="font-bold">100%</span>
            </div>
            <button onclick="adjust('contrast', 10)" class="step-btn"><i class="fas fa-plus"></i></button>
        </div>

        <button onclick="download()" class="w-full bg-white text-black p-4 rounded-xl font-bold">
            <i class="fas fa-save ml-2"></i> حفظ في استوديو الصور
        </button>
    </div>

    <script>
        let currentFilters = { brightness: 100, contrast: 100 };

        async function generate() {
            const b = document.getElementById('brand').value;
            const i = document.getElementById('idea').value;
            if(!b) return alert("يرجى كتابة الاسم");

            // إظهار اللودر
            document.getElementById('loader').style.display = 'flex';
            document.getElementById('dots').style.display = 'flex';
            document.getElementById('btnAction').disabled = true;

            const seed = Math.floor(Math.random() * 99999);
            const prompt = `professional clean logo, ${b}, ${i}, vector, isolated on white background`;
            const url = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=1000&height=1000&seed=${seed}&nologo=true`;

            const img = document.getElementById('mainImg');
            img.src = url;

            img.onload = () => {
                img.style.display = 'block';
                document.getElementById('placeholder').style.display = 'none';
                document.getElementById('loader').style.display = 'none';
                document.getElementById('controls').classList.remove('hidden');
                document.getElementById('btnAction').disabled = false;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
        }

        // نظام التحكم بالضغط (Step Control) بديل السلايدر
        function adjust(type, change) {
            currentFilters[type] += change;
            if(currentFilters[type] < 50) currentFilters[type] = 50;
            if(currentFilters[type] > 200) currentFilters[type] = 200;

            // تحديث الأرقام
            document.getElementById(type === 'brightness' ? 'brightVal' : 'contVal').innerText = currentFilters[type] + '%';
            
            // تطبيق الفلتر
            document.getElementById('mainImg').style.filter = 
                `brightness(${currentFilters.brightness}%) contrast(${currentFilters.contrast}%)`;
        }

        function download() {
            const url = document.getElementById('mainImg').src;
            const a = document.createElement('a');
            a.href = url;
            a.download = 'nexus-logo.png';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS MOBILE FIX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* منع أي حركات افتراضية للمتصفح قد تعطل التطبيق */
        html, body { 
            position: fixed; 
            overflow: hidden; 
            width: 100%; 
            height: 100%; 
            background: #000;
            touch-action: none; /* يمنع المتصفح من اعتراض حركات اللمس */
        }
        
        #app-wrapper {
            height: 100%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 20px;
        }

        .canvas-area {
            width: 100%;
            aspect-ratio: 1/1;
            background: #111;
            border: 2px solid #222;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* أزرار كبيرة سهلة الضغط للهاتف */
        .step-btn {
            background: #1a1a1a;
            border: 1px solid #333;
            color: #d4af37;
            padding: 15px;
            border-radius: 12px;
            font-size: 20px;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .step-btn:active {
            background: #333;
        }

        input {
            background: #111 !important;
            border: 1px solid #333 !important;
            color: white !important;
            padding: 15px !important;
            border-radius: 12px !important;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="app-wrapper">
    <h1 class="text-center text-amber-500 font-black text-xl mb-6 tracking-widest">NEXUS STUDIO PRO</h1>

    <div class="canvas-area mb-6 shadow-2xl">
        <p id="placeholderText" class="text-gray-600 text-sm">أدخل البيانات واضغط "إنشاء"</p>
        <img id="logoResult" class="hidden w-full h-full object-contain rounded-xl">
        
        <div id="loader" class="absolute inset-0 bg-black/90 hidden flex-col items-center justify-center rounded-xl">
            <div class="w-10 h-10 border-4 border-amber-500 border-t-transparent rounded-full animate-spin mb-4"></div>
            <p class="text-amber-500 text-xs font-bold">جاري التصميم...</p>
        </div>
    </div>

    <div class="space-y-4 mb-6">
        <input type="text" id="brandName" placeholder="اسم العلامة التجارية">
        <button onclick="generate()" id="genBtn" class="w-full bg-amber-600 text-white p-4 rounded-xl font-bold shadow-lg">
            إنشاء الشعار الآن
        </button>
    </div>

    <div id="controls" class="hidden space-y-4 bg-zinc-900/80 p-5 rounded-2xl border border-zinc-800">
        <p class="text-center text-xs text-gray-500 font-bold uppercase">تعديل مستوى الإضاءة</p>
        <div class="flex gap-4 items-center">
            <button onclick="changeBright(-10)" class="step-btn">➖</button>
            <div class="flex-1 text-center">
                <span id="brightVal" class="text-xl font-bold">100%</span>
            </div>
            <button onclick="changeBright(10)" class="step-btn">➕</button>
        </div>
        <button onclick="download()" class="w-full bg-white text-black p-4 rounded-xl font-bold mt-4">حفظ الصورة</button>
    </div>
</div>

<script>
    let brightness = 100;

    async function generate() {
        const name = document.getElementById('brandName').value;
        if(!name) return alert("يرجى كتابة الاسم!");

        document.getElementById('loader').style.display = 'flex';
        document.getElementById('genBtn').disabled = true;

        const seed = Math.floor(Math.random() * 9999);
        const url = `https://image.pollinations.ai/prompt/${encodeURIComponent('professional logo for ' + name + ', vector, minimalist')}?nologo=true&seed=${seed}`;

        const img = document.getElementById('logoResult');
        img.src = url;

        img.onload = () => {
            img.classList.remove('hidden');
            document.getElementById('placeholderText').style.display = 'none';
            document.getElementById('loader').style.display = 'none';
            document.getElementById('controls').classList.remove('hidden');
            document.getElementById('genBtn').disabled = false;
        };
    }

    function changeBright(amount) {
        brightness += amount;
        if(brightness < 50) brightness = 50;
        if(brightness > 200) brightness = 200;
        
        document.getElementById('brightVal').innerText = brightness + '%';
        document.getElementById('logoResult').style.filter = `brightness(${brightness}%)`;
    }

    function download() {
        const url = document.getElementById('logoResult').src;
        window.open(url, '_blank');
    }
</script>

</body>
</html>
